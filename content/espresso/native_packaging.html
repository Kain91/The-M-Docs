<!-- HEADER -->
<div class="contentHeader">
    <a name="top"></a>

    <h1>Native Packaging</h1>

    <div class="directoryPath">
        Create app store ready mobile apps (e.g. ipa/apk) by simply running one single command.
	</div>

    <span class="navlink" onclick="scroll('content')">Content</span> &#183;
    <span class="navlink" onclick="scroll('req')">Requirements</span> &#183;
    <span class="navlink" onclick="scroll('config')">Configuration</span> &#183;
    <!--<span class="navlink" onclick="scroll('incluence')">How does MVC influence app development with The-M-Project?</span>-->
</div>
<!-- END OF HEADER -->

<!-- BASICS-->
<div class="contentBasics">
    <a name="content"><h2 class="line">What is this about?</h2></a>

    <p class="text">
        This article is about the native packaging feature of Espresso. We could also call it a tutorial
        since it will cover all the necessary steps to get from your web app to a app store ready iOS/Android
        application. First we will talk about some requirements your system has to provide in order to
        use this feature. Then we'll cover the configuration part which is actually pretty intuitive but
        some explanation might help anyway. Afterwards we will take a look at the available Espresso commands
        for this feature and then finally end up in a working sample. Let's go!
    </p>

    <span class="navlink" onclick="scroll('top')">&uarr; top</span>
</div>
<!-- END OF BASICS -->

<!-- BASICS-->
<div class="contentBasics">
    <a name="req"><h2 class="line">The requirements</h2></a>

    <p class="text">
        The Espresso package feature currently supports native build for iOS and Android. But since Espresso
        basically only offers a simple and convenient interface to the platform's tools, there need to be some
        things available on your system in order to use this feature. Espresso does not ship with an Android SDK,
        an iOS SDK or a iOS PhoneGap installation - but, depending on the targeted platform, they are required.
    </p>

    <p class="text">
        So let's first talk about <strong>Android</strong>. What you will need to do is:
    </p>
    
    <ol>
        <li>
            Download the Android SDK:
            <a href="http://developer.android.com/sdk/index.html" target="_blank">http://developer.android.com/sdk/index.html</a>
        </li>
        <li>
            Follow the install and setup instructions: <a href="http://developer.android.com/sdk/index.html" target="_blank">http://developer.android.com/sdk/installing.html</a>
        </li>
        <li>
            Add the SDK's <span class="code">tools/</span> and <span class="code">platform-tools/</span> directories
            to your <span class="code">PATH</span> environment variable: Look for "How to update your PATH" on the
            instructions page
        </li>
        <li>
            Setup at least on so called Android Virtual Device (AVD) with the desired API level:
            <a href="http://developer.android.com/sdk/index.html" target="_blank">http://developer.android.com/guide/developing/devices/index.html</a>
            <br/>Later on you will have to tell Espresso that API level and it will automatically launch the application in the corresponding
            emulator.
        </li>
    </ol>

    <p class="text">
        And how about <strong>iOS</strong>? Here we go:
    </p>

    <ol>
        <li>
            Make sure you are running on Mac OS X! Unfortunately there is no alternative when building for iOS.
        </li>
        <li>
            Download Xcode (including the iOS SDK):
            <a href="http://developer.apple.com/xcode/" target="_blank">http://developer.apple.com/xcode/</a>
        </li>
        <li>
            Follow the install and setup instructions: <a href="http://developer.apple.com/support/xcode/" target="_blank">http://developer.apple.com/support/xcode/</a>
        </li>
        <li>
            Download PhoneGap: <a href="http://phonegap.com/download" target="_blank">http://phonegap.com/download</a>
        </li>
        <li>
            Follow the install and setup instructions: <a href="http://phonegap.com/start#ios-x4" target="_blank">http://phonegap.com/start#ios-x4</a>
        </li>
    </ol>

    <span class="navlink" onclick="scroll('top')">&uarr; top</span>
</div>
<!-- END OF BASICS -->

<!-- BASICS-->
<div class="contentBasics">
    <a name="config"><h2 class="line">The configuration</h2></a>

    <p class="text">
        Now your system is ready to use the native packaging feature. What else do we need? Sure, an app! For this article
        we will work with the Twitter app within our
        <a href="github.com/mwaylabs/The-M-Project-Sample-Apps" target="_blank">samples repository</a>.
        But feel free to work with your own app. It shouldn't be hard to adjust these following steps to your app.
    </p>

    <p class="text">
        There's only one file you will have to work on to get the packaging up and running. One you might have worked on
        before for other reasons: your project's <strong>config.json</strong>
        <br/>
        With the native packaging feature the <strong>config.json</strong> accepts a new section called <span class="code">package</span>.
    </p>

    <p class="text">
        To get started let's take a look at a working <span class="code">package</span> configuration for the mentioned Twitter sample. Since
        you might (and often will) have several configurations for different platforms, we have to name them. In this sample our configuration
        is called <span class="code">myIOSConfig</span>. This name will be used later on for the actual espresso package call.
    </p>
<pre class="syntax javascript">"package": {
    "myIOSConfig": {
        "method": "PhoneGap",
        "os": "iOS",
        "sdk": "iphonesimulator4.3",
        "package": "com.tmp.twitter",
        "activity": "Twitter",
        "mode": "debug",
        "plists": {
            "PhoneGap": {
                "ExternalHosts": ["*"]
            }
        }
    }
}</pre>

    <p class="text">
        Depending on the application and the targeted platform(s) this configuration might be more complex. But for not let's talk
        about the basic properties for the <strong>iOS</strong> platform:
    </p>

    <ol>
        <li>
            <strong>method</strong>: This property specifies what packaging method to use. By now we only support PhoneGap. In the future there might come more.
        </li>
        <li>
            <strong>os</strong>: This property specifies what the targeted operating system for this configuration is. Currently this has to be
            <span class="code">iOS</span> or <span class="code">Android</span>
        </li>
        <li>
            <strong>sdk</strong>: This property specifies what target (simulator/device) and which SDK version to use. It should have the
            form <span class="code">iphonesimulator&lt;version&gt;</span> or <span class="code">iphoneos&lt;version&gt;</span> with &lt;version&gt;
            being greater or equal to 4.0. Make sure the specified SDK version is available on your system.
        </li>
        <li>
            <strong>package</strong>: Provide a package name your the application in the form <span class="code">&lt;tld&gt;.&lt;yourdomain&gt;.&lt;yourapp&gt;</span>.
            The default value is <span class="code">com.test.mypackage</span>.
        </li>
        <li>
            <strong>activity</strong>: This specifies the name of the activity resp. the native application's name. The default is
            <span class="code">MyActivity</span>. Typically you would set this to the web app's name.
        </li>
        <li>
            <strong>mode</strong>: This determines the build mode of the application. Currently there are two modes available:
            <span class="code">debug</span> (default) and <span class="code">release</span>. In debug mode, you won't have to provide any further information. If
            the release mode is activated, you will have to specify additional information for the code signing process. We will discuss this later.
        </li>
        <li>
            <strong>plists</strong>: This property can be used to edit the native project's plist file. The provided JSON will automatically be transformed
            into a proper XML file for the native build process. One important section of the plist is the <span class="code">PhoneGap</span> section. As you
            can see in the sample configuration we set the <span class="code">ExternalHosts</span> to <span class="code">*</span> to be able to connect to
            any URL out there. Depending on your application their might be more properties needed within this section. If you are using some PhoneGap features
            like the accelerometer, you e.g. will have to add a <span class="code">Plugins</span> section to that property as follows:
<pre class="syntax javascript">"PhoneGap": {
    "ExternalHosts": ["*"],
    "Plugins": {
        "com.phonegap.accelerometer": "PGAccelerometer"
    }
}</pre>
        </li>
    </ol>

    <span class="navlink" onclick="scroll('top')">&uarr; top</span>
</div>
<!-- END OF BASICS -->






